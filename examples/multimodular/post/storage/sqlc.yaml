version: '2'
plugins:
  - name: graphql
    wasm:
      url: https://github.com/debugger84/sqlc-graphql/releases/download/v0.1.2/sqlc-graphql.wasm
      sha256: fe1bbdf7679a24c18cdbef48d2519c9ef517db6316d264f4857a21ef8d3b4e9f

  - name: golang
    wasm:
      url: https://github.com/debugger84/sqlc-gen-go/releases/download/v1.3.1/sqlc-gen-go.wasm
      sha256: fe6e5a2b75153ecba02b0c30bf4a11db2120bef537b650299473da133d272bf4
sql:
  - engine: "postgresql"
    schema:
     - "migrations"
    queries:
      - "query"

    codegen:
      - plugin: graphql
        out: "../graphql"
        options:
          ## avoid adding the schema name to the generated names of objects
          default_schema: "post"
          ## the full package name pointing to the code generated by golang plugin
          package: "multimodular/post/storage"
          ## generate GraphQL enums
          emit_all_enum_values: true
          ## create several default types and directives to work in conjunction with the gqlgen library https://gqlgen.com/
          gen_common_parts: false
          ## exclude columns from the generated schema
          ## Author - is the generated Graphql object
          ## and CreatedAt is the column name to be excluded
          exclude:
            - "Post.createdAt"
      ## options for the default golang generation plugin https://github.com/sqlc-dev/sqlc-gen-go
      - plugin: golang
        out: "./"
        options:
          ## avoid adding the schema name to the generated names of objects
          default_schema: "post"
          package: "storage"
          sql_package: "pgx/v5"
          emit_json_tags: true
          emit_all_enum_values: true
          json_tags_case_style: "camel"
          out: "./"
          overrides:
            - db_type: "uuid"
              nullable: true
              engine: "postgresql"
              go_type:
                import: "github.com/gofrs/uuid"
                package: "uuid"
                type: "NullUUID"
            - db_type: "uuid"
              nullable: false
              engine: "postgresql"
              go_type:
                import: "github.com/gofrs/uuid"
                package: "uuid"
                type: "UUID"
            - db_type: "pg_catalog.timestamptz"
              go_type:
                import: "gopkg.in/guregu/null.v4"
                package: "null"
                type: "Time"
              nullable: true
            - db_type: "pg_catalog.timestamptz"
              go_type: "time.Time"
